?tbss
example(tbss)
?tbss
help(package = "VARDetect")
?lag.selection
lag.selection
library(VARDetect)
remove.packages("VARDetect")
?tbss
library(VARDetect)
?tbss
nob <- (10^3) # number of time points
p <- 15; # number of time series components
brk <- c(floor(nob/3),floor(2*nob/3),nob+1); # true break points with nob+1 as the last element
m0 <- length(brk) -1; # number of break points
q.t <- 1; # the true AR order
m <- m0+1 #number of segments
try<-simu_var('sparse',nob=nob,k=p,lags=q.t,brk = brk,sp_pattern="off-diagonal",seed=1)
data <- try$series
data <- as.matrix(data)
#run the bss method
fit <- tbss(data, method = "sparse", q = q.t)
print(fit)
summary(fit)
plot(fit, data, display = "cp")
plot(fit, data, display = "param")
library(VARDetect)
help(package = VARDetect)
help(package = VARDetect)
nob <- 4000; p <- 15
brk <- c(floor(nob / 3), floor(nob * 2 / 3), nob + 1)
m <- length(brk); q.t <- 2
signals <- c(-0.6, -0.4, 0.6, 0.4, -0.6, -0.4)
sp_density <- rep(0.05, m * q.t)
try <- simu_var(method = "sparse", nob = nob, k = p, lags = q.t, brk = brk, sigma = diag(p), signals = signals, sp_density = sp_density, sp_pattern = "random")
print(plot_matrix(do.call("cbind", try$model_param), m * q.t))
try <- simu_var(method = "sparse", nob = nob, k = p, lags = q.t, brk = brk, sigma = diag(p), seed = 1, signals = signals, sp_density = sp_density, sp_pattern = "random")
print(plot_matrix(do.call("cbind", try$model_param), m * q.t))
try <- simu_var(method = "sparse", nob = nob, k = p, lags = q.t, brk = brk, sigma = diag(p), seed = 1, signals = signals, sp_density = sp_density, sp_pattern = "off-diagonal")
print(plot_matrix(do.call("cbind", try$model_param), m * q.t))
fit <- tbss(data, method = "sparse", q = q.t)
data <- as.matrix(try$series)
fit <- tbss(data, method = "sparse", q = q.t)
print(fit)
plot(fit, data, display = "cp")
plot(fit, data, display = "param")
nob <- 1000; p <- 15
brk <- c(floor(nob / 2), nob + 1)
m <- length(brk); q.t <- 2
signals <- c(-0.8, 0.6, 0.4)
try <- simu_var(method = 'sparse', nob = nob, k = p, brk = brk, signals = signals, lags_vector = c(1, 2), sp_pattern = "off-diagonal")
data <- as.matrix(try$series)
try <- simu_var(method = 'sparse', nob = nob, k = p, brk = brk, seed = 1, signals = signals, lags_vector = c(1, 2), sp_pattern = "off-diagonal")
data <- as.matrix(try$series)
MTS::MTSplot(data)
print(plot_matrix(do.call("cbind", try$model_param), m * q.t))
lag_selection(data = data, method = "sparse", lag_candidates = c(1, 2, 3, 4))
q <- lag_selection(data = data, method = "sparse", lag_candidates = c(1, 2, 3, 4))
q
lag = q
lag
fit <- tbss(data, method = "sparse", q = lag, refit = TRUE)
print(fit)
lag
data
plot(fit, data, display = "cp")
plot(fit, data, display = "param")
